# to allow cron jobs to read keyring
touch $HOME/.Xdbus
chmod 600 $HOME/.Xdbus
env | grep DBUS_SESSION_BUS_ADDRESS > $HOME/.Xdbus
echo 'export DBUS_SESSION_BUS_ADDRESS' >> $HOME/.Xdbus

# using terminal emulator xterm with 256 color support
case "$TERM" in
  xterm)TERM=xterm-256color;;
esac

# git ps line
if [[ -e ~/.git-prompt.sh ]]; then
  source ~/.git-prompt.sh
fi

#
[[ -f ~/.LESS_TERMCAP ]] && . ~/.LESS_TERMCAP

if [[ -e $HOME/bin ]]; then
  PATH=$HOME/bin/:$PATH
fi

export LD_LIBRARY_PATH=/usr/lib64:/usr/local/lib
SASAL_LIB=/usr/local/lib/sasl2
if [[ -e $SASAL_LIB ]]; then
  LD_LIBRARY_PATH=$SASAL_LIB:$LD_LIBRARY_PATH
fi

TMUX_COMPLETION=/usr/share/doc/tmux/examples/bash_completion_tmux.sh
if [[ -e $TMUX_COMPLETION ]]; then
  source $TMUX_COMPLETION
fi

# alias
alias sp-khal='khal calendar -a red -a work -a personal --format="{red-bold}{start-time}{reset}-{green-bold}{end-time}{reset} {calendar-color}{title}{reset}{yellow}{repeat-symbol}{reset} [{cyan}{location}{reset}][{magenta}{calendar}{reset}]"'
alias sp-sync='~/dotfiles/lib/keypass_cron.sh; ~/dotfiles/lib/offlineimap_cron.sh; ~/dotfiles/lib/vdirsyncer_cron.sh'
alias port-scan='netstat -alnptu | egrep '\''Proto|LISTEN'\'''

alias sp-open="~/dotfiles/lib/open_keyring.py"
alias sp-space="du -hsc *"
alias sp-root="cd \`~/dotfiles/lib/git_root.sh\`"
#tmux
alias tmux='tmux -2'
alias sp-source='tmux source-file ~/.tmux.conf; powerline-daemon --replace'
# meta alias
alias sp-alias="vim ~/dotfiles/extrarc && source ~/dotfiles/extrarc"
alias sp-vimrc="vim ~/.vimrc"
# dropbox
alias sp-tmux="vim ~/Dropbox/root/[]ref/linux/tmux.txt"
alias sp-vim="vim ~/Dropbox/root/[]ref/linux/vim.txt"
alias sp-vim-cpp="vim ~/Dropbox/root/[]ref/linux/vim/cpp"
alias sp-vim-extra="vim ~/Dropbox/root/[]ref/linux/vim/extra"
alias sp-vim-jump="vim ~/Dropbox/root/[]ref/linux/vim/jump.md"
alias sp-xclip="vim ~/Dropbox/root/[]ref/linux/xclip.txt"
alias sp-gdb="vim ~/Dropbox/root/[]ref/linux/debug/gdb.md"
alias sp-perf="vim ~/Dropbox/root/[]ref/linux/debug/perf.txt"
alias sp-ref="cd ~/Dropbox/root/[]ref/linux/"
alias sp-todo="cd ~/Dropbox/term_todo/"
alias sp-systemd="vim ~/Dropbox/root/[]ref/linux/systemd.md"
alias sp-gcc="vim ~/Dropbox/root/[]ref/c/gcc.md"
alias sp-linker="vim ~/Dropbox/root/[]ref/linux/debug/linker-debug.md"
alias sp-sed="vim ~/Dropbox/root/[]ref/linux/sed.md"
alias sp-ack="vim ~/Dropbox/root/[]ref/linux/ack.md"
alias sp-linux="cd ~/Dropbox/root/[]ref/linux"
# tags
function setup_project(){
  if [ ! -e .git ];then
    echo 'project root is required to be git:ed'
    exit 1
  fi
#
  rm .tags
  touch .tags
  ctags -R *
#
  # ack-grep -f --cpp > cscope.files
  # cscope -b -q -k
#
  gtags
#
  #-c g++ -F ycm -F cc
 ~/sources/YCM-Generator/config_gen.py -b cmake .
}
alias sp-setup='setup_project'
