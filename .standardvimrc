set nocompatible

" if has('vim_starting')
  set encoding=utf-8      " The encoding displayed
  set fileencoding=utf-8  " The encoding of the resulting output file
  scriptencoding utf-8
" endif

if has('gui_running')
  " configure font and font size for gvim
  set guifont=Consolas:h9
  " a gui pops up allowing you to configure font, size...
  " set guifont=*
endif

if $TERM == "xterm-256color" || $TERM == "screen-256color" || $COLORTERM == "gnome-terminal" || $TERM == "urxvt" || $TERM == "tmux-256color"
  set t_Co=256
endif

"
filetype on                       " Enable file type detection
filetype plugin on                " Enable file type plug-ins
filetype indent plugin on         " file type specific indentation support + loading language indentation specific files

" General {{{
let mapleader = "\<Space>"        " map leader to  <space>
" set mouse=a                     " Enables scrolling terminal.(mouse mode)
set pastetoggle=<f5>              " vim will not perform any formatting when toggled on
" }}}

" UI {{{
set ruler                         " Display the ruler
set showcmd                       " Show incomplete vim motions as I type
set relativenumber                " Relative line numbers
set number                        " Relative + Absolute number
set lazyredraw                    " don't bother updating screen during macro playback
set showmatch                     " highlight matching [{()}]
set title                         " change the terminal's title

set novisualbell                  " don't beep
set noerrorbells                  " don't beep

set splitright                    " open new pane to the right

set scrolloff=5                   " keep at least 5 lines above/below

if !has('win32unix') && !has('win64unix')
  " does not work in cygwin
  set ttyfast                     " Faster redraw
endif

" Highlight current line
" Enable cursorline only on the active buffer
augroup AutogroupCursorLine
    "https://stackoverflow.com/a/12018552
    autocmd!
    autocmd VimEnter,WinEnter,BufWinEnter * setlocal cursorline
    autocmd WinLeave * setlocal nocursorline
augroup END
" }}}

" syntax {{{
syntax enable                     " Highlight the syntax.
" }}}

" folding {{{
set nofoldenable                  " disable folding
" }}}

" gvim {{{
" hide all gui
set guioptions=
" }}}

" command(:) {{{
set history=1000                 " remember more commands and search history
set wildmode=longest:full,full   " bash like command(:) completion when tab
set wildmenu                     " Show command(:) completion with tab

" ignore these files when :edit <tab>
set wildignore=*.swp,*.bak,*.pyc,*.class,*.o,*.exe,*.dat,*.bin,*.jar,*.out,*.pdf,*.cache,*.part,*.zip,*.tar,*.tar.gz,*.so,*.a,*.stackdump,*.bmp,*.gif,*.ico,*.jpg,*.png
set wildignore+=*~,*.swp,*.tmp
" }}}

" Blank charcters {{{
" debug set with "set list?" ?: means print current value
set list                              " show special chars, such as tab: eol: trail: extends: nbsp:

" chars to show for blank characters
set listchars=tab:·»
set listchars+=eol:¬
set listchars+=trail:·

" set showbreak=↪\                    " useful indication of wrapping
set showbreak="\u21aa "
" }}}

" Undo {{{
" https://advancedweb.hu/2017/09/12/vim-using-undo-branches
set undolevels=1000      " Use many levels of undo
set undofile             " File Persistent undo
set undodir=$TEMP        " Store undo file in tmp directory
" }}}

" {{{
augroup AutogroupFileSpecific
  autocmd!

  " manually set filetype based on ext
  autocmd BufNewFile,BufFilePre,BufRead *.md set ft=markdown
  autocmd BufNewFile,BufRead *.nasm set ft=nasm

  " type specific settings
  autocmd FileType markdown,python set ts=2 sw=2 expandtab
  autocmd FileType gitcommit,markdown,text,mail set textwidth=80
  autocmd FileType gitcommit,markdown,text,mail set colorcolumn=-1   " display bar at textwidth
  autocmd FileType gitcommit,markdown,text,mail set complete+=kspell
  autocmd FileType gitcommit,mail set spell                          " enable spelling for these types

  " set file type for files without extension like <atomic>
  autocmd BufRead,BufNewFile /usr/include/c++/* set syntax=cpp

augroup END
" }}}

" Get rid of nasty lag on ESC (timeout and ttimeout seem useless) sp??
augroup AutogroupEscapeLag
  autocmd!
  au InsertEnter * set timeoutlen=1
  au InsertLeave * set timeoutlen=1000
augroup END
set timeoutlen=1000 ttimeoutlen=0
" set esckeys " A <esc> is always a <esc> not part a escape sequence(used by older terminals?)

" Search {{{
set incsearch                     " search wile you type
set smartcase                     " Case insensitive search, except when capital letters are used.
set ignorecase                    " ignore case when searching
set hlsearch                      " highlight search result
" }}}

" Visual mode {{{
" move up/down by visual line, will treat wrapped lines as real lines
nnoremap j gj
nnoremap k gk
" }}}

" Spell {{{
map <silent><f6> <esc>:setlocal spell!<CR>
map zn ]s
map zp [s
" map <leader>sa zg
" map <leader>sq z=
" Drop down menu with spell corrections
nnoremap <leader>z ea<C-X><C-S>

" underline wrongly spelled words
hi clear SpellBad
hi SpellBad cterm=underline

set spelllang=en_gb               " Specify the spell checking language.
set nospell                       " Disable spell checking by default.
set dictionary+=/usr/share/dict/words

abbreviate teh the
abbreviate wehn when
abbreviate fro for
abbreviate utillity utility
abbreviate allways always
abbreviate highligt highlight
abbreviate allready already
abbreviate exclusve exclusive
abbreviate exclusve exclusive
abbreviate beahviour behaviour
abbreviate autocompleteion autocompletion
abbreviate completeion completion
abbreviate abreviate abbreviate
abbreviate aquire acquire
abbreviate coaless coalesce
abbreviate coalessed coalesced
abbreviate noxcept noexcept
abbreviate probobly probably
abbreviate charactor character
abbreviate paralell parallel
abbreviate itterations iterations
abbreviate itteration iteration

" }}}

set nowrap                        " do not wrap long lines
set backspace=indent,eol,start    " allow backspacing over everything in insert mode

" Tab {{{
set tabstop=2                     " Number of spaces to represent a <TAB> character from file
set expandtab                     " <tab> is converted to spaces
set shiftwidth=2                  " number of spaces to use for autoindenting
set smarttab                      " insert tabs on the start of a line according
                                  " to shiftwidth, not tabstop
" }}}

" Indentation {{{
set autoindent                    " always set autoindenting on
set copyindent                    " copy the previous indentation on autoindenting
set smartindent                   " smart indentation
" }}}

" Backup {{{
set nobackup            " no bak
set noswapfile          " no swap
set autoread            " auto reload after outside changes

" set backup
" set backupdir=~/.vim-tmp,~/.tmp,~/tmp,/var/tmp,/tmp
" set backupskip=/tmp/*,/private/tmp/*
" set directory=~/.vim-tmp,~/.tmp,~/tmp,/var/tmp,/tmp
" set writebackup
" }}}

" Custom mappings {{{
" Alternative save
nnoremap <silent> <leader>w <esc>:wa<CR>
" Alternative quit
nnoremap <silent> <leader>q <esc>:q<CR>

map <silent> <leader>, <esc>:noh<CR>

" resize split
map <silent> <leader>- <esc>:vertical resize -5<CR>
map <silent> <leader>+ <esc>:vertical resize +5<CR>

" Alternative Moving around splits with the leader key
nmap <silent> <leader>h :wincmd h<CR>
nmap <silent> <leader>j :wincmd j<CR>
nmap <silent> <leader>k :wincmd k<CR>
nmap <silent> <leader>l :wincmd l<CR>

" Create vertical pane
nnoremap <leader>s <esc>:vnew<CR>
" Create horizontal pane
" nnoremap <leader>h <esc>:sp<CR>
" Create tab
nnoremap <silent><leader>e <esc>:tabedit<CR>

" new line above and below without entering insert mode
map <silent> <leader>o o<esc>
map <silent> <leader>O O<esc>

" half page down/up
map <silent> ö <C-D>
map <silent> Ö <C-U>
"
" page up/down
map <silent> å <PageUp>
map <silent> ä <PageDown>

" pane navigation
map <silent> <leader>1 <esc>1gt
map <silent> <leader>2 <esc>2gt
map <silent> <leader>3 <esc>3gt
map <silent> <leader>4 <esc>4gt
map <silent> <leader>5 <esc>5gt
map <silent> <leader>6 <esc>6gt
map <silent> <leader>7 <esc>7gt
map <silent> <leader>8 <esc>8gt
map <silent> <leader>9 <esc>9gt

" behave similar to D
noremap Y y$
"
" Navigation captial H/L goto extreme Right/Left
noremap H _
noremap L g_

nnoremap <CR> :
vnoremap <CR> :

" Replay macro
noremap Q @q

" }}}

" jumplist {{{
" Store relative line number jumps in the jumplist if they exceed a threshold.
nnoremap <expr> k (v:count > 3 ? "m'" . v:count : '') . 'k'
nnoremap <expr> j (v:count > 3 ? "m'" . v:count : '') . 'j'

nnoremap <expr> + (v:count > 3 ? "m'" . v:count : '') . '+'
nnoremap <expr> - (v:count > 3 ? "m'" . v:count : '') . '-'
" }}}

" Disable Mappings {{{

" Arrow keys
" nnoremap <left> <nop>
" nnoremap <right> <nop>
" nnoremap <up> <nop>
" nnoremap <down> <nop>

" inoremap <left> <nop>
" inoremap <right> <nop>
" inoremap <up> <nop>
" inoremap <down> <nop>

" disable f1 help
inoremap <F1> <nop>
nnoremap <F1> <nop>
vnoremap <F1> <nop>

" disable man
map <S-k> <Nop>

" Avoid unintentional switches to Ex mode.
nnoremap Q <nop>

" Stop that stupid window from popping up
nmap q: <esc>:q

nnoremap ' `
nnoremap ` '

"
map + <nop>
map - <nop>

" }}}

" hexedit {{{
" from :h hex-editing
" xxd is a utility to convert to/from hex - used when opening and closing the
" bin files. when opening a bin file vim will open it for hex editing
augroup BinaryHexEdit
  au!
  au BufReadPre  *.bin let &bin=1
  au BufReadPost *.bin if &bin | %!xxd
  au BufReadPost *.bin set ft=xxd | endif
  au BufWritePre *.bin if &bin | %!xxd -r
  au BufWritePre *.bin endif
  au BufWritePost *.bin if &bin | %!xxd
  au BufWritePost *.bin set nomod | endif
augroup END
" }}}

" Smooth Scrolling {{{
" from :h scroll-smooth
map <C-U> <C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y><C-Y>
map <C-D> <C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E><C-E>
" }}}
"
" modeline {{{
set modelines=1   " turn on vim settings that will be read from the last line
" example:
" vim:foldmethod=marker:foldlevel=0
" }}}
